# Simplified Maddy configuration for testing
$(hostname) = localhost

# SMTP submission (port 587)
submission tcp://0.0.0.0:587 {
    auth <local_auth>
    source <local_rewrite>
    destination <local_delivery>
    deliver_to <queue>
}

# SMTP relay (port 25)
smtp tcp://0.0.0.0:25 {
    source <remote_rewrite>
    destination <remote_delivery>
    deliver_to <queue>
}

# Simple local authentication
auth.plain local_auth {
    username "newsletter"
    password "test123"
}

# Local rewrite
rewrite <local_rewrite> {
    to localhost
}

# Remote rewrite
rewrite <remote_rewrite> {
    to localhost
}

# Local delivery (just log for testing)
delivery <local_delivery> {
    destination localhost {
        deliver_to <log_delivery>
    }
}

# Remote delivery (just log for testing)
delivery <remote_delivery> {
    destination * {
        deliver_to <log_delivery>
    }
}

# Log delivery (for testing)
target <log_delivery> {
    pipe {
        command /bin/cat
    }
}

# Queue
queue <queue> {
    target <log_delivery>
}

# Logging
log {
    level info
    syslog
}
